<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Full Favicon Pack -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
<link rel="icon" type="image/png" sizes="512x512" href="/android-chrome-512x512.png">

  <script src="seo-auto.js"></script>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Batch QR Generator</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<style>
 body{font-family:Poppins,system-ui;background:#f4f7fb;margin:0;padding:20px}
 .wrap{max-width:900px;margin:12px auto;background:#fff;padding:18px;border-radius:12px}
 textarea{width:100%;height:140px;padding:10px;border-radius:10px;border:1px solid #e6e9ef}
 .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;margin-top:12px}
 .card{padding:10px;border-radius:8px;background:#fafafa;border:1px solid #ececec;text-align:center}
 .btn{padding:7px 12px;border:none;border-radius:6px;background:#005dff;color:#fff;cursor:pointer;font-size:14px}
 .btn:hover{background:#003fcc}
 .small-btn{margin-top:6px;font-size:12px;padding:6px 10px}
</style>
</head>
<body>
<div class="wrap">
  <h1>Batch QR Generator</h1>
  <p>Enter one text/URL per line and click Generate.</p>

  <textarea id="input" placeholder="https://example.com/page1
https://example.com/page2
Hello World"></textarea>
  
  <div style="margin-top:10px">
    <button class="btn" id="gen">Generate</button>
    <button class="btn" id="downloadZip">Download All (ZIP)</button>
  </div>

  <div class="grid" id="out"></div>
</div>

<script>
const gen = document.getElementById('gen');
const out = document.getElementById('out');

gen.onclick = () => {
  out.innerHTML = '';
  const lines = document.getElementById('input').value.split('\n').map(s => s.trim()).filter(Boolean);

  if(!lines.length) return alert('Enter at least one line.');

  lines.forEach((txt, index) => {
    const c = document.createElement('div'); 
    c.className = 'card';

    const holder = document.createElement('div');
    new QRCode(holder, { text: txt, width: 150, height: 150, colorDark: '#000', colorLight: '#fff' });

    const label = document.createElement('div'); 
    label.style.marginTop = '6px';
    label.style.fontSize = '12px';
    label.textContent = txt;

    const btn = document.createElement('button');
    btn.className = 'btn small-btn';
    btn.textContent = 'Download PNG';

    btn.onclick = () => {
      const img = holder.querySelector('img') || holder.querySelector('canvas');
      if(img.tagName === 'IMG') {
        saveImage(img.src, `qr-${index + 1}.png`);
      } else {
        img.toBlob(blob => saveAs(blob, `qr-${index + 1}.png`));
      }
    };

    c.appendChild(holder);
    c.appendChild(label);
    c.appendChild(btn);
    out.appendChild(c);
  });
};

function saveImage(url, filename) {
  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  a.click();
}

// ZIP Download
document.getElementById('downloadZip').onclick = async () => {
  const imgs = out.querySelectorAll('img, canvas');
  if(!imgs.length) return alert('Generate first.');

  const zip = new JSZip();
  let count = 1;

  for (let el of imgs) {
    if (el.tagName.toLowerCase() === 'img') {
      const data = await fetch(el.src).then(res => res.blob());
      zip.file(`qr-${count}.png`, data);
    } else {
      const blob = await new Promise(res => el.toBlob(res));
      zip.file(`qr-${count}.png`, blob);
    }
    count++;
  }

  zip.generateAsync({ type: "blob" }).then(content => saveAs(content, "all-qr.zip"));
};
</script>
</body>
</html>
