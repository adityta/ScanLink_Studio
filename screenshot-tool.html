<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Screenshot Tool</title>
<style>
body{font-family:Poppins;background:#f4f7fb;padding:18px}
.container{max-width:900px;margin:auto;background:#fff;padding:14px;border-radius:12px}
button,input{padding:10px;border-radius:8px;border:1px solid #e6e9ef;width:100%;margin-top:8px}
.preview{margin-top:12px;border:1px solid #e6e9ef;border-radius:8px;padding:12px}
</style>
</head>
<body>
<div class="container">
  <h2>Screenshot Tool (Capture Visible Area)</h2>
  <p>This captures the current tab visible area using the Screen Capture API (will ask permission).</p>
  <button id="cap">Capture Screen</button>
  <div class="preview" id="out"></div>
</div>

<script>
cap.onclick=async()=>{
  try{
    const s = await navigator.mediaDevices.getDisplayMedia({video:true});
    const track = s.getVideoTracks()[0];
    const img = document.createElement('video');
    img.autoplay = true; img.muted=true; img.playsInline=true;
    img.srcObject = new MediaStream([track]);
    out.innerHTML=''; out.appendChild(img);
    img.onloadedmetadata = ()=>{
      const c=document.createElement('canvas');
      c.width = img.videoWidth; c.height = img.videoHeight;
      const ctx = c.getContext('2d');
      ctx.drawImage(img,0,0,c.width,c.height);
      const a=document.createElement('a'); a.href=c.toDataURL(); a.download='screenshot.png'; a.click();
      track.stop();
    };
  }catch(e){ alert('Permission denied or not supported'); }
};
</script>
</body>
</html>
